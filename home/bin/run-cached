#!/usr/bin/env bash

interval="$1"
shift
cache="$HOME/.run-cache/$*"

mkdir -p "$(dirname "$cache")"

now=$(date +%s)
if [[ -f "$cache" ]]; then
    last_run=$(stat --format %Y "$cache")
    time_since_last_run=$(( now - last_run ))
else
    time_since_last_run="$interval"
fi

if (( time_since_last_run >= interval )); then
    "$@" >"$cache"
fi

cat "$cache"
